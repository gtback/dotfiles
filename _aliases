#!/bin/bash

### Date aliases
alias today="date +%F"
alias now="date +%FT%T"

### File listing aliases
alias l='exa -lFhg -m --time-style=long-iso'
alias ll='exa -l'
ls() {
    echo "How about trying 'exa'?"
}

### Git aliases
alias branch='git symbolic-ref --short HEAD'
alias ga='git add'
alias gb='git branch'
alias gba='git branch --all'
alias gbac='git branch --all --contains'
alias gbc='git branch --contains'
alias gc='git commit'
alias gcm='git checkout main 2>/dev/null || git checkout master'
alias gco='git checkout'
alias gd='git diff'
alias gdca='git diff --cached'
alias gfa='git fetch --all'
alias glg='git log --stat'
alias gm='git merge'
alias grv='git remote -v'
alias gst='git status'

# These git aliases are defined in _gitconfig
alias gpom="git pom"
alias gssp="git ssp"

### Python Aliases
alias lsvirtualenv="lsvirtualenv -b"
alias pyws="sed -i -e 's/^[ \r\t]*$//'"
alias pip-rm-all="python -m pip freeze | sed 's/^-e.*egg=//' | xargs python -m pip uninstall -y"
pip-upgrade-all() {
    python -m pip list --outdated --disable-pip-version-check | awk 'NR>2 {print $1 "==" $3}' | xargs python -m pip install
}
# Check if there's an existing alias for pip, and if so, remove it.
alias pip >/dev/null && unalias pip
pip() {
    echo "Use 'python -m pip' instead"
}

alias version="echo -n \"VirtualBox \" && VBoxManage --version && vagrant --version && git --version && tmux -V &&  vim --version | head -1"

alias vagrant-ids="grep '.*' ~/code/**/.vagrant/machines/*/virtualbox/index_uuid"
alias zreload=". ~/.zshrc && echo 'ZSH config reloaded from ~/.zshrc'"
alias lspath='f(){echo ${PATH} | tr ":" "\n"};f'
alias proxies="env | grep -i proxy"

alias git=hub
alias ip="http https://httpbin.org/ip | jq -r '.origin'"
alias tm="tmuxinator start"

alias xo="xargs open"

# List top level npm packages (global and local)
#   (https://gist.github.com/yyx990803/6045243)
alias nlg="npm list -g --depth=0 2>/dev/null"
alias nl="npm list --depth=0 2>/dev/null"

tlsdates() {
    echo | openssl s_client -servername "$1" -connect "$1":443 2>/dev/null | openssl x509 -noout -dates
}

### kubectl aliases
alias k=kubectl
alias kdp="kubectl describe pod"
alias kge="kubectl get events"
alias kgn="kubectl get namespaces"
alias kgp="kubectl get pods"

function gi() {
    for var in "$@"; do
        curl -sLw "\\n" "https://www.gitignore.io/api/$var" |
            grep -v "toptal" sed '/./,/^$/!d' |
            sed '$d'
    done
}
